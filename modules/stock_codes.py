"""
股票代碼管理模組 - 台股股票代碼和名稱對應
"""
import os

# 預設台股代碼列表（涵蓋主要上市公司）
DEFAULT_CODES = [
    "1101", "1102", "1103", "1104", "1108", "1109", "1110", "1201", "1203", "1210",
    "1213", "1215", "1216", "1217", "1218", "1219", "1220", "1225", "1227", "1229",
    "1231", "1232", "1233", "1234", "1235", "1236", "1256", "1301", "1303", "1304",
    "1305", "1307", "1308", "1309", "1310", "1312", "1313", "1314", "1315", "1316",
    "1319", "1321", "1323", "1324", "1325", "1326", "1337", "1338", "1339", "1340",
    "1341", "1342", "1402", "1409", "1410", "1413", "1414", "1416", "1417", "1418",
    "1419", "1423", "1432", "1434", "1435", "1436", "1437", "1438", "1439", "1440",
    "1441", "1442", "1443", "1444", "1445", "1446", "1447", "1449", "1451", "1452",
    "1453", "1454", "1455", "1456", "1457", "1459", "1460", "1463", "1464", "1465",
    "1466", "1467", "1468", "1470", "1471", "1472", "1473", "1474", "1475", "1476",
    "1477", "1503", "1504", "1506", "1512", "1513", "1514", "1515", "1516", "1517",
    "1519", "1521", "1522", "1524", "1525", "1526", "1527", "1528", "1529", "1530",
    "1531", "1532", "1533", "1535", "1536", "1537", "1538", "1539", "1540", "1541",
    "1558", "1560", "1563", "1568", "1582", "1583", "1587", "1589", "1590", "1597",
    "1598", "1603", "1604", "1605", "1608", "1609", "1611", "1612", "1614", "1615",
    "1616", "1617", "1618", "1626", "1702", "1707", "1708", "1709", "1710", "1711",
    "1712", "1713", "1714", "1717", "1718", "1720", "1721", "1722", "1723", "1725",
    "1726", "1727", "1730", "1731", "1732", "1733", "1734", "1735", "1736", "1737",
    "1752", "1760", "1762", "1773", "1776", "1783", "1786", "1789", "1795", "1802",
    "1805", "1806", "1808", "1809", "1810", "1817", "1903", "1904", "1905", "1906",
    "1907", "1909", "2002", "2006", "2007", "2008", "2009", "2010", "2012", "2013",
    "2014", "2015", "2017", "2020", "2022", "2023", "2024", "2025", "2027", "2028",
    "2029", "2030", "2031", "2032", "2033", "2034", "2038", "2049", "2059", "2062",
    "2069", "2101", "2102", "2103", "2104", "2105", "2106", "2107", "2108", "2109",
    "2114", "2115", "2201", "2204", "2206", "2207", "2208", "2211", "2227", "2228",
    "2231", "2233", "2236", "2239", "2241", "2243", "2247", "2248", "2250", "2301",
    "2302", "2303", "2305", "2308", "2312", "2313", "2314", "2316", "2317", "2321",
    "2323", "2324", "2327", "2328", "2329", "2330", "2331", "2332", "2337", "2338",
    "2340", "2342", "2344", "2345", "2347", "2348", "2349", "2351", "2352", "2353",
    "2354", "2355", "2356", "2357", "2359", "2360", "2362", "2363", "2364", "2365"
]

# 股票代碼與名稱對應表
STOCK_NAMES = {
    "1101": "台泥", "1102": "亞泥", "1103": "嘉泥", "1104": "環泥", "1108": "幸福",
    "1109": "信大", "1110": "東泥", "1201": "味全", "1203": "味王", "1210": "大成",
    "1213": "大飲", "1215": "卜蜂", "1216": "統一", "1217": "愛之味", "1218": "泰山",
    "1219": "福壽", "1220": "台榮", "1225": "福懋油", "1227": "佳格", "1229": "聯華",
    "1231": "聯華食", "1232": "大統益", "1233": "天仁", "1234": "黑松", "1235": "興泰",
    "1236": "宏亞", "1256": "鮮活果汁-KY", "1301": "台塑", "1303": "南亞", "1304": "台聚",
    "1305": "華夏", "1307": "三芳", "1308": "亞聚", "1309": "台達化", "1310": "台苯",
    "1312": "國喬", "1313": "聯成", "1314": "中石化", "1315": "達新", "1316": "上曜",
    "1319": "東陽", "1321": "大洋", "1323": "永裕", "1324": "地球", "1325": "恆大",
    "1326": "台化", "1337": "再生-KY", "1338": "廣華-KY", "1339": "昭輝", "1340": "勝悅-KY",
    "1341": "富林-KY", "1342": "八貫", "1402": "遠東新", "1409": "新纖", "1410": "南染",
    "1413": "宏洲", "1414": "東和", "1416": "廣豐", "1417": "嘉裕", "1418": "東華",
    "1419": "新紡", "1423": "利華", "1432": "大魯閣", "1434": "福懋", "1435": "中福",
    "1436": "華友聯", "1437": "勤益控", "1438": "三地開發", "1439": "雋揚", "1440": "南紡",
    "1441": "大東", "1442": "名軒", "1443": "立益物流", "1444": "力麗", "1445": "大宇",
    "1446": "宏和", "1447": "力鵬", "1449": "佳和", "1451": "年興", "1452": "宏益",
    "1453": "大將", "1454": "台富", "1455": "集盛", "1456": "怡華", "1457": "宜進",
    "1459": "聯發", "1460": "宏遠", "1463": "強盛新", "1464": "得力", "1465": "偉全",
    "1466": "聚隆", "1467": "南緯", "1468": "昶和", "1470": "大統新創", "1471": "首利",
    "1472": "三洋實業", "1473": "台南", "1474": "弘裕", "1475": "業旺", "1476": "儒鴻",
    "1477": "聚陽", "1503": "士電", "1504": "東元", "1506": "正道", "1512": "瑞利",
    "1513": "中興電", "1514": "亞力", "1515": "力山", "1516": "川飛", "1517": "利奇",
    "1519": "華城", "1521": "大億", "1522": "堤維西", "1524": "耿鼎", "1525": "江申",
    "1526": "日馳", "1527": "鑽全", "1528": "恩德", "1529": "樂事綠能", "1530": "亞崴",
    "1531": "高林股", "1532": "勤美", "1533": "車王電", "1535": "中宇", "1536": "和大",
    "1537": "廣隆", "1538": "正峰", "1539": "巨庭", "1540": "喬福", "1541": "錩泰",
    "1558": "伸興", "1560": "中砂", "1563": "巧新", "1568": "倉佑", "1582": "信錦",
    "1583": "程泰", "1587": "吉茂", "1589": "永冠-KY", "1590": "亞德客-KY", "1597": "直得",
    "1598": "岱宇", "1603": "華電", "1604": "聲寶", "1605": "華新", "1608": "華榮",
    "1609": "大亞", "1611": "中電", "1612": "宏泰", "1614": "三洋電", "1615": "大山",
    "1616": "億泰", "1617": "榮星", "1618": "合機", "1626": "艾美特-KY", "1702": "南僑",
    "1707": "葡萄王", "1708": "東鹼", "1709": "和益", "1710": "東聯", "1711": "永光",
    "1712": "興農", "1713": "國化", "1714": "和桐", "1717": "長興", "1718": "中纖",
    "1720": "生達", "1721": "三晃", "1722": "台肥", "1723": "中碳", "1725": "元禎",
    "1726": "永記", "1727": "中華化", "1730": "花仙子", "1731": "美吾華", "1732": "毛寶",
    "1733": "五鼎", "1734": "杏輝", "1735": "日勝化", "1736": "喬山", "1737": "臺鹽",
    "1752": "南光", "1760": "寶齡富錦", "1762": "中化生", "1773": "勝一", "1776": "展宇",
    "1783": "和康生", "1786": "科妍", "1789": "神隆", "1795": "美時", "1802": "台玻",
    "1805": "寶徠", "1806": "冠軍", "1808": "潤隆", "1809": "中釉", "1810": "和成",
    "1817": "凱撒衛", "1903": "士紙", "1904": "正隆", "1905": "華紙", "1906": "寶隆",
    "1907": "永豐餘", "1909": "榮成", "2002": "中鋼", "2006": "東和鋼鐵", "2007": "燁興",
    "2008": "高興昌", "2009": "第一銅", "2010": "春源", "2012": "春雨", "2013": "中鋼構",
    "2014": "中鴻", "2015": "豐興", "2017": "官田鋼", "2020": "美亞", "2022": "聚亨",
    "2023": "燁輝", "2024": "志聯", "2025": "千興", "2027": "大成鋼", "2028": "威致",
    "2029": "盛餘", "2030": "彰源", "2031": "新光鋼", "2032": "新鋼", "2033": "佳大",
    "2034": "允強", "2038": "海光", "2049": "上銀", "2059": "川湖", "2062": "橋椿",
    "2069": "運錩", "2101": "南港", "2102": "泰豐", "2103": "台橡", "2104": "國際中橡",
    "2105": "正新", "2106": "建大", "2107": "厚生", "2108": "南帝", "2109": "華豐",
    "2114": "鑫永銓", "2115": "六暉-KY", "2201": "裕隆", "2204": "中華", "2206": "三陽工業",
    "2207": "和泰車", "2208": "台船", "2211": "長榮鋼", "2227": "裕日車", "2228": "劍麟",
    "2231": "為升", "2233": "宇隆", "2236": "百達-KY", "2239": "英利-KY", "2241": "艾姆勒",
    "2243": "宏旭-KY", "2247": "汎德永業", "2248": "華勝-KY", "2250": "IKKA-KY", "2301": "光寶科",
    "2302": "麗正", "2303": "聯電", "2305": "全友", "2308": "台達電", "2312": "金寶",
    "2313": "華通", "2314": "台揚", "2316": "楠梓電", "2317": "鴻海", "2321": "東訊",
    "2323": "中環", "2324": "仁寶", "2327": "國巨*", "2328": "廣宇", "2329": "華泰",
    "2330": "台積電", "2331": "精英", "2332": "友訊", "2337": "旺宏", "2338": "光罩",
    "2340": "台亞", "2342": "茂矽", "2344": "華邦電", "2345": "智邦", "2347": "聯強",
    "2348": "海悅", "2349": "錸德", "2351": "順德", "2352": "佳世達", "2353": "宏碁",
    "2354": "鴻準", "2355": "敬鵬", "2356": "英業達", "2357": "華碩", "2359": "所羅門",
    "2360": "致茂", "2362": "藍天", "2363": "矽統", "2364": "倫飛", "2365": "昆盈"
}


def get_stock_codes():
    """
    從環境變數讀取股票代碼，如果未設定則使用預設列表

    Returns:
        list: 股票代碼列表
    """
    codes_str = os.environ.get("TWSE_CODES", ",".join(DEFAULT_CODES))
    return codes_str.split(",")


def get_stock_name(code: str) -> str:
    """
    取得股票名稱

    Args:
        code: 股票代碼

    Returns:
        str: 股票名稱，如果找不到則返回代碼本身
    """
    return STOCK_NAMES.get(code, code)


def get_picks_top_k() -> int:
    """
    取得選股數量上限

    Returns:
        int: TOP_K 數量
    """
    return int(os.environ.get("TOP_K", "300"))